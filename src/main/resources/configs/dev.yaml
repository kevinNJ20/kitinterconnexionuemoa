# ============================================================================
# CONFIGURATION FINALE MULESOFT - URLS CORRIG√âES
# Fichier: src/main/resources/configs/dev.yaml
# ============================================================================

# Configuration HTTP
http:
  port: "8080"
  host: "0.0.0.0"
  
# Configuration S√©curit√©  
api:
  id: "20414799"
  main: "kitinterconnexionuemoa-main"
  key:
    commission: "COMMISSION_SECRET_KEY"

# ‚úÖ CORRECTION MAJEURE: URLs des Syst√®mes Externes - URLs R√âELLES des simulateurs Vercel
systeme:
  paysA:
    # ‚ö†Ô∏è REMPLACER par l'URL Vercel r√©elle de Pays A
    host: "localhost"  # ‚Üê URL √† adapter selon votre d√©ploiement
    port: "3001"
    url: "https://simulateur-pays-a-cotier.vercel.app"
    endpoints:
      health: "/api/health"
      mainlevee: "/api/mainlevee/autorisation"
      
  paysB:
    # ‚ö†Ô∏è REMPLACER par l'URL Vercel r√©elle de Pays B
    host: "localhost"  # ‚Üê URL √† adapter selon votre d√©ploiement
    port: "3002"
    url: "https://simulateur-pays-b-hinterland.vercel.app"
    endpoints:
      health: "/api/health"
      manifeste: "/api/manifeste/reception"

# ‚úÖ CORRECTION MAJEURE: URL Commission UEMOA - URL R√âELLE du simulateur
commission:
  uemoa:
    # ‚ö†Ô∏è REMPLACER par l'URL Vercel r√©elle de Commission UEMOA
    host: "localhost"  # ‚Üê URL √† adapter selon votre d√©ploiement
    port: "3003"
    url: "https://simulateur-commission-uemoa.vercel.app"
    endpoints:
      health: "/api/health"
      tracabilite: "/api/tracabilite/enregistrer"  # ‚úÖ Path correct SANS /v1
    auth:
      token: "COMMISSION_TOKEN"

### Database config (inchang√©) ####
db:
  #driver: "org.h2.Driver"
  driver: "org.postgresql.Driver"
  #url_interco: "jdbc:h2:mem:interconnexion;DB_CLOSE_DELAY=-1"
  url_interco: "jdbc:postgresql://db.hgkuqkjvgshfrayjelps.supabase.co:5432/postgres?sslmode=require&user=postgres&password=kZeR8HgjDqKzmk5n"
  user: "postgres"
  password: "kZeR8HgjDqKzmk5n"
  
# ‚úÖ NOUVELLE APPROCHE: Supabase REST API
supabase:
  # üîë Vos vraies cl√©s r√©cup√©r√©es du Dashboard
  url: "https://hgkuqkjvgshfrayjelps.supabase.co"
  host: "hgkuqkjvgshfrayjelps.supabase.co"  # ‚úÖ AJOUT: Host pour MuleSoft
  port: "443"  # ‚úÖ AJOUT: Port HTTPS
  anon_key: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imhna3Vxa2p2Z3NoZnJheWplbHBzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTEyNzU4MzYsImV4cCI6MjA2Njg1MTgzNn0.FGy7iFKfzsiDZiPssrvBZk2HtVM_jCKMSsg69lT98gQ"
  service_role_key: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imhna3Vxa2p2Z3NoZnJheWplbHBzIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1MTI3NTgzNiwiZXhwIjoyMDY2ODUxODM2fQ.vdwtSoUnmixm49JHone4YhRZgy8agl7Hcotb7HWpCsU"
  
  # ‚úÖ Configuration REST API
  rest:
    base_url: "https://hgkuqkjvgshfrayjelps.supabase.co/rest/v1"
    base_path: "/rest/v1"  # ‚úÖ AJOUT: Path de base pour MuleSoft
    endpoints:
      manifestes: "/manifestes_recus"
      paiements: "/paiements_recus" 
      autorisations: "/autorisations_mainlevee"
      tracabilite: "/tracabilite_echanges"
      configurations: "/configurations_pays"
      metriques: "/metriques_operations"
      declarations: "/declarations_recues"
  
  # ‚úÖ Headers par d√©faut
  headers:
    content_type: "application/json"
    prefer: "return=representation"
    user_agent: "Kit-Interconnexion-UEMOA/1.0"
  
oauth:
  client:
    id: "interconnexion_client"
    secret: "interconnexion_secret"

# Configuration Monitoring
monitoring:
  enabled: "true"
  
# Configuration Logging
logging:
  level: "INFO"
  
# ‚úÖ AM√âLIORATION: Configuration CORS √©tendue pour les tests depuis les dashboards
cors:
  enabled: "true"
  origins: 
    - "*.vercel.app"  # Accepter toutes les URLs Vercel pour les tests
    - "localhost"     # Pour les tests locaux
    - "127.0.0.1"     # Pour les tests locaux
  headers:
    - "Content-Type"
    - "Authorization"
    - "X-Source-Country"
    - "X-Source-System"
    - "X-Correlation-ID"
    - "X-Test-Type"
    - "X-Authorization-Source"
    - "User-Agent"

# ‚úÖ AM√âLIORATION: Configuration timeout pour la robustesse
external:
  timeout:
    connection: "15000"  # 15 secondes (augment√© pour Vercel)
    read: "20000"        # 20 secondes (augment√© pour Vercel)
    
# ‚úÖ AM√âLIORATION: Configuration retry pour la robustesse Vercel
retry:
  attempts: "3"
  delay: "3000"  # 3 secondes entre tentatives (augment√© pour Vercel)