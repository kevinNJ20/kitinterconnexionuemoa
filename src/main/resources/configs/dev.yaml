# ============================================================================
# CONFIGURATION MULESOFT CORRIGÉE - Nouveaux Endpoints Commission
# Fichier: src/main/resources/configs/dev.yaml
# ============================================================================

# Configuration HTTP
http:
  port: "8080"
  host: "0.0.0.0"
  
# Configuration Sécurité  
api:
  id: "20414799"
  main: "kitinterconnexionuemoa-main"
  key:
    commission: "COMMISSION_SECRET_KEY"

# ✅ CORRECTION: URLs des Systèmes Externes
systeme:
  paysA:
    host: "localhost"
    port: "3001"
    url: "https://simulateur-pays-a-cotier.vercel.app"
    endpoints:
      health: "/api/health"
      mainlevee: "/api/mainlevee/autorisation"
      
  paysB:
    host: "localhost"
    port: "3002"
    url: "https://simulateur-pays-b-hinterland.vercel.app"
    endpoints:
      health: "/api/health"
      manifeste: "/api/manifeste/reception"

# ✅ CORRECTION MAJEURE: Commission UEMOA avec endpoints séparés
commission:
  uemoa:
    host: "localhost"
    port: "3003"
    url: "https://simulateur-commission-uemoa.vercel.app"
    endpoints:
      health: "/api/health"
      # ✅ NOUVEAUX ENDPOINTS SPÉCIALISÉS
      manifeste: "/api/tracabilite/manifeste"        # Pour les transmissions de manifeste
      declaration: "/api/tracabilite/declaration"    # Pour les soumissions de déclaration
      tracabilite: "/api/tracabilite/enregistrer"    # Endpoint générique (conservé pour compatibilité)
      statistiques: "/api/statistiques"
      dashboard: "/api/dashboard"
    auth:
      token: "COMMISSION_TOKEN"

# Configuration Base de Données
db:
  driver: "org.postgresql.Driver"
  url_interco: "jdbc:postgresql://db.hgkuqkjvgshfrayjelps.supabase.co:5432/postgres?sslmode=require&user=postgres&password=kZeR8HgjDqKzmk5n"
  user: "postgres"
  password: "kZeR8HgjDqKzmk5n"
  
# ✅ Configuration Supabase REST API
supabase:
  url: "https://hgkuqkjvgshfrayjelps.supabase.co"
  host: "hgkuqkjvgshfrayjelps.supabase.co"
  port: "443"
  anon_key: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imhna3Vxa2p2Z3NoZnJheWplbHBzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTEyNzU4MzYsImV4cCI6MjA2Njg1MTgzNn0.FGy7iFKfzsiDZiPssrvBZk2HtVM_jCKMSsg69lT98gQ"
  service_role_key: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imhna3Vxa2p2Z3NoZnJheWplbHBzIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1MTI3NTgzNiwiZXhwIjoyMDY2ODUxODM2fQ.vdwtSoUnmixm49JHone4YhRZgy8agl7Hcotb7HWpCsU"
  
  rest:
    base_url: "https://hgkuqkjvgshfrayjelps.supabase.co/rest/v1"
    base_path: "/rest/v1"
    endpoints:
      manifestes: "/manifestes_recus"
      paiements: "/paiements_recus" 
      autorisations: "/autorisations_mainlevee"
      tracabilite: "/tracabilite_echanges"
      configurations: "/configurations_pays"
      metriques: "/metriques_operations"
      declarations: "/declarations_recues"
  
  headers:
    content_type: "application/json"
    prefer: "return=representation"
    user_agent: "Kit-Interconnexion-UEMOA/1.0"
  
oauth:
  client:
    id: "interconnexion_client"
    secret: "interconnexion_secret"

# Configuration Monitoring
monitoring:
  enabled: "true"
  
# Configuration Logging
logging:
  level: "INFO"
  
# ✅ Configuration CORS
cors:
  enabled: "true"
  origins: 
    - "*.vercel.app"
    - "localhost"
    - "127.0.0.1"
  headers:
    - "Content-Type"
    - "Authorization"
    - "X-Source-Country"
    - "X-Source-System"
    - "X-Correlation-ID"
    - "X-Test-Type"
    - "X-Authorization-Source"
    - "User-Agent"

# ✅ Configuration timeout et retry
external:
  timeout:
    connection: "15000"  # 15 secondes
    read: "20000"        # 20 secondes
    
retry:
  attempts: "3"
  delay: "3000"  # 3 secondes entre tentatives